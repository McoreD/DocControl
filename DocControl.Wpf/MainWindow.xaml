<Window x:Class="DocControl.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DocControl.Wpf"
        mc:Ignorable="d"
        Title="DocControl" Height="500" Width="850">
    <TabControl>
        <!-- Recommend Tab -->
        <TabItem Header="Recommend">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Natural Language Query:" Margin="0,0,0,5"/>
                <TextBox Grid.Row="1" Name="txtNlq" Height="60" TextWrapping="Wrap" AcceptsReturn="True" Margin="0,0,0,10"/>

                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,10">
                    <Button Name="btnRecommend" Content="Interpret &amp; Recommend" Padding="10,5" Margin="0,0,10,0" Click="btnRecommend_Click"/>
                </StackPanel>

                <TextBox Grid.Row="3" Name="txtNlqResult" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" Margin="0,0,0,10"/>
                
                <TextBlock Grid.Row="4" Name="lblRecommendResult" FontWeight="Bold" Margin="0,0,0,5"/>
                <TextBlock Grid.Row="5" Name="lblRecommendInfo" Text="AI-powered code recommendations based on natural language descriptions" FontStyle="Italic"/>
            </Grid>
        </TabItem>

        <!-- Generate Tab -->
        <TabItem Header="Generate">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Label Grid.Row="0" Grid.Column="0" Content="Level 1:" VerticalAlignment="Center"/>
                <ComboBox Grid.Row="0" Grid.Column="1" Name="cmbLevel1" Margin="0,5" IsEditable="True" SelectionChanged="cmbLevel1_SelectionChanged"/>

                <Label Grid.Row="1" Grid.Column="0" Content="Level 2:" VerticalAlignment="Center"/>
                <ComboBox Grid.Row="1" Grid.Column="1" Name="cmbLevel2" Margin="0,5" IsEditable="True" SelectionChanged="cmbLevel2_SelectionChanged"/>

                <Label Grid.Row="2" Grid.Column="0" Content="Level 3:" VerticalAlignment="Center"/>
                <ComboBox Grid.Row="2" Grid.Column="1" Name="cmbLevel3" Margin="0,5" IsEditable="True" SelectionChanged="cmbLevel3_SelectionChanged"/>

                <CheckBox Grid.Row="3" Grid.Column="1" Name="chkEnableLevel4" Content="Enable Level 4" Margin="0,5" Checked="chkEnableLevel4_Changed" Unchecked="chkEnableLevel4_Changed"/>
                
                <Label Grid.Row="4" Grid.Column="0" Content="Level 4:" VerticalAlignment="Center"/>
                <ComboBox Grid.Row="4" Grid.Column="1" Name="cmbLevel4" Margin="0,5" IsEditable="True" IsEnabled="False"/>

                <Label Grid.Row="5" Grid.Column="0" Content="Free Text:" VerticalAlignment="Center"/>
                <TextBox Grid.Row="5" Grid.Column="1" Name="txtFreeText" Margin="0,5"/>

                <Label Grid.Row="6" Grid.Column="0" Content="Extension:" VerticalAlignment="Center"/>
                <TextBox Grid.Row="6" Grid.Column="1" Name="txtExtension" Margin="0,5"/>

                <Button Grid.Row="7" Grid.Column="1" Name="btnGenerate" Content="Generate Document" Margin="0,10" Padding="10,5" Click="btnGenerate_Click" HorizontalAlignment="Left"/>

                <StackPanel Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,10">
                    <TextBlock Name="lblGenerateResult" FontWeight="Bold" TextWrapping="Wrap"/>
                    <TextBlock Name="lblNoDelete" Text="Note: Generated documents are audited and cannot be deleted." Foreground="Red" Margin="0,5"/>
                </StackPanel>
            </Grid>
        </TabItem>

        <!-- Codes Tab -->
        <TabItem Header="Codes">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                    <Button Name="btnEditCodes" Content="Edit Codes..." Padding="10,5" Margin="0,0,10,0" Click="btnEditCodes_Click" Background="#FF4CAF50" Foreground="White"/>
                    <Button Name="btnCodesImportCsv" Content="Import CSV..." Padding="10,5" Margin="0,0,10,0" Click="btnCodesImportCsv_Click"/>
                    <Button Name="btnCodesRefresh" Content="Refresh" Padding="10,5" Margin="0,0,10,0" Click="btnCodesRefresh_Click"/>
                    <Button Name="btnDeleteCode" Content="Delete Selected" Padding="10,5" Margin="0,0,10,0" Click="btnDeleteCode_Click"/>
                    <Button Name="btnPurgeCodes" Content="Purge All Codes" Padding="10,5" Background="#FFCC0000" Foreground="White" Click="btnPurgeCodes_Click"/>
                </StackPanel>

                <TextBlock Grid.Row="1" Name="lblCodesInfo" Text="Hierarchical codes used in document generation" Margin="0,0,0,10"/>

                <ListView Grid.Row="2" Name="lvCodes">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Level" Width="80" DisplayMemberBinding="{Binding Level}"/>
                            <GridViewColumn Header="Code" Width="200" DisplayMemberBinding="{Binding Code}"/>
                            <GridViewColumn Header="Description" Width="400" DisplayMemberBinding="{Binding Description}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </TabItem>

        <!-- Documents Tab -->
        <TabItem Header="Documents">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- First row: Level filters -->
                <Grid Grid.Row="0" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0" Content="Level 1:" VerticalAlignment="Center"/>
                    <TextBox Grid.Column="1" Name="txtDocsFilterLevel1" Margin="0,5"/>

                    <Label Grid.Column="2" Content="Level 2:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <TextBox Grid.Column="3" Name="txtDocsFilterLevel2" Margin="0,5"/>

                    <Label Grid.Column="4" Content="Level 3:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <TextBox Grid.Column="5" Name="txtDocsFilterLevel3" Margin="0,5"/>
                </Grid>

                <!-- Second row: File Name and buttons -->
                <Grid Grid.Row="1" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0" Content="Free Text:" VerticalAlignment="Center"/>
                    <TextBox Grid.Column="1" Name="txtDocsFilterFileName" Margin="0,5"/>

                    <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Name="btnDocsFilter" Content="Filter" Padding="10,5" Margin="5,0" Click="btnDocsFilter_Click"/>
                        <Button Name="btnDocsRefresh" Content="Refresh" Padding="10,5" Margin="5,0" Click="btnDocsRefresh_Click"/>
                        <Button Name="btnDocsCopy" Content="Copy to Clipboard" Padding="10,5" Margin="5,0" Click="btnDocsCopy_Click"/>
                    </StackPanel>
                </Grid>
                
                <TextBlock Grid.Row="2" Name="lblImportPerSeriesDocs" Text="Recent documents in the system" Margin="0,0,0,10"/>

                <TextBlock Grid.Row="3" Name="lblDocsResultCount" Text="" Margin="0,0,0,5" FontWeight="Bold"/>

                <ListView Grid.Row="4" Name="lvDocs" MouseDoubleClick="lvDocs_DoubleClick">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Width="250" DisplayMemberBinding="{Binding Code}">
                                <GridViewColumn.Header>
                                    <GridViewColumnHeader Content="Code" Click="lvDocsColumnHeader_Click" Tag="Code"/>
                                </GridViewColumn.Header>
                            </GridViewColumn>
                            <GridViewColumn Width="250" DisplayMemberBinding="{Binding FreeText}">
                                <GridViewColumn.Header>
                                    <GridViewColumnHeader Content="Free Text" Click="lvDocsColumnHeader_Click" Tag="FreeText"/>
                                </GridViewColumn.Header>
                            </GridViewColumn>
                            <GridViewColumn Width="100" DisplayMemberBinding="{Binding CreatedBy}">
                                <GridViewColumn.Header>
                                    <GridViewColumnHeader Content="Created By" Click="lvDocsColumnHeader_Click" Tag="CreatedBy"/>
                                </GridViewColumn.Header>
                            </GridViewColumn>
                            <GridViewColumn Width="150" DisplayMemberBinding="{Binding CreatedAt}">
                                <GridViewColumn.Header>
                                    <GridViewColumnHeader Content="Created At" Click="lvDocsColumnHeader_Click" Tag="CreatedAt"/>
                                </GridViewColumn.Header>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </TabItem>

        <!-- Audit Tab -->
        <TabItem Header="Audit">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0" Margin="0,0,0,10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Content="User:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Name="txtAuditUser" Margin="0,5"/>

                    <Label Grid.Row="0" Grid.Column="2" Content="Action:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <TextBox Grid.Row="0" Grid.Column="3" Name="txtAuditAction" Margin="0,5"/>

                    <StackPanel Grid.Row="0" Grid.Column="4" Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Name="btnAuditFilter" Content="Filter" Padding="10,5" Margin="5,0" Click="btnAuditFilter_Click"/>
                        <Button Name="btnAuditRefresh" Content="Refresh" Padding="10,5" Click="btnAuditRefresh_Click"/>
                    </StackPanel>
                </Grid>

                <ListView Grid.Row="1" Name="lvAudit">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Timestamp" Width="150" DisplayMemberBinding="{Binding Timestamp}"/>
                            <GridViewColumn Header="User" Width="100" DisplayMemberBinding="{Binding User}"/>
                            <GridViewColumn Header="Action" Width="120" DisplayMemberBinding="{Binding Action}"/>
                            <GridViewColumn Header="Document ID" Width="100" DisplayMemberBinding="{Binding DocumentId}"/>
                            <GridViewColumn Header="Payload" Width="300" DisplayMemberBinding="{Binding Payload}"/>
                        </GridView>
                    </ListView.View>
                </ListView>

                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                    <Button Name="btnAuditPrev" Content="Previous" Padding="10,5" Margin="5,0" Click="btnAuditPrev_Click"/>
                    <TextBlock Name="lblAuditPage" Text="Page 1 of 1" VerticalAlignment="Center" Margin="10,0"/>
                    <Button Name="btnAuditNext" Content="Next" Padding="10,5" Margin="5,0" Click="btnAuditNext_Click"/>
                </StackPanel>
            </Grid>
        </TabItem>

        <!-- Import Tab -->
        <TabItem Header="Import">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="200"/>
                </Grid.RowDefinitions>

                <Button Grid.Row="0" Name="btnImportCsv" Content="Import Documents CSV..." Padding="10,5" Margin="0,0,0,10" HorizontalAlignment="Left" Click="btnImportCsv_Click"/>
                
                <TextBlock Grid.Row="1" Name="lblImportResult" FontWeight="Bold" Margin="0,0,0,5"/>
                <TextBlock Grid.Row="2" Name="lblImportNote" Text="CSV Format: code,filename (e.g., ABC-001-XYZ-0001,mydoc.pdf)" Margin="0,0,0,10"/>

                <GroupBox Grid.Row="3" Header="Invalid Entries" Margin="0,0,0,10">
                    <ListBox Name="lstImportInvalid"/>
                </GroupBox>

                <StackPanel Grid.Row="4" Orientation="Horizontal" Margin="0,0,0,10">
                    <CheckBox Name="chkSeedCounters" Content="Show series counters" IsChecked="True" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <Button Name="btnSeedSelected" Content="Seed Selected Series" Padding="10,5" Click="btnSeedSelected_Click"/>
                    <TextBlock Name="lblImportPerSeries" Text="Select series to seed their next counters" VerticalAlignment="Center" Margin="10,0,0,0"/>
                </StackPanel>

                <ListView Grid.Row="5" Name="lvImportSummary">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Series" Width="250" DisplayMemberBinding="{Binding SeriesText}"/>
                            <GridViewColumn Header="Max Number" Width="100" DisplayMemberBinding="{Binding MaxNumber}"/>
                            <GridViewColumn Header="Next Number" Width="100" DisplayMemberBinding="{Binding NextNumber}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </TabItem>

        <!-- Settings Tab -->
        <TabItem Header="Settings">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Content="Separator:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Name="txtSeparator" Margin="0,5"/>

                    <Label Grid.Row="1" Grid.Column="0" Content="Padding Length:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Name="txtPadding" Margin="0,5"/>

                    <CheckBox Grid.Row="2" Grid.Column="1" Name="chkSettingsEnableLevel4" Content="Enable Level 4" Margin="0,10"/>

                    <Label Grid.Row="3" Grid.Column="0" Content="AI Provider:" VerticalAlignment="Center"/>
                    <ComboBox Grid.Row="3" Grid.Column="1" Name="cmbProvider" Margin="0,5">
                        <ComboBoxItem Content="OpenAI"/>
                        <ComboBoxItem Content="Gemini"/>
                    </ComboBox>

                    <Label Grid.Row="4" Grid.Column="0" Content="OpenAI Model:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="4" Grid.Column="1" Name="txtOpenAiModel" Margin="0,5"/>

                    <Label Grid.Row="5" Grid.Column="0" Content="OpenAI API Key:" VerticalAlignment="Center"/>
                    <PasswordBox Grid.Row="5" Grid.Column="1" Name="txtOpenAiKey" Margin="0,5"/>

                    <Label Grid.Row="6" Grid.Column="0" Content="Gemini Model:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="6" Grid.Column="1" Name="txtGeminiModel" Margin="0,5"/>

                    <Label Grid.Row="7" Grid.Column="0" Content="Gemini API Key:" VerticalAlignment="Center"/>
                    <PasswordBox Grid.Row="7" Grid.Column="1" Name="txtGeminiKey" Margin="0,5"/>

                    <Button Grid.Row="8" Grid.Column="1" Name="btnSaveSettings" Content="Save Settings" Padding="10,5" Margin="0,20,0,0" HorizontalAlignment="Left" Click="btnSaveSettings_Click"/>
                </Grid>
            </ScrollViewer>
        </TabItem>
    </TabControl>
</Window>
